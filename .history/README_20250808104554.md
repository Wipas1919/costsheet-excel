# EC - AI Cost Estimation System

## Overview
AI-powered system for analyzing and estimating exhibition booth costs by processing images and generating Excel files.

## Features
- **Image Analysis**: Analyzes booth layout and component list images
- **Object Classification**: Categorizes objects into 4 main types
- **Dimension Extraction**: Extracts size information from images
- **Excel Generation**: Automatically creates cost sheets
- **Price Calculation**: Calculates costs from database

## System Architecture

### 1. Image Processing & Analysis
- Receives booth layout and component list images
- Uses AI Vision Model for analysis
- Categorizes objects:
  - Structure
  - Furniture & Plant
  - Graphic
  - Electrical

### 2. Data Processing
- Separates graphics from structures
- Validates dimension accuracy
- Creates list_id for each item
- Calculates quantities by type

### 3. Price Integration
- Compares with price database
- Calculates unit prices
- Calculates total costs
- Adds electrical costs

### 4. Excel Generation
- Sends data to Windmill API
- Creates cost sheet files
- Returns download links

## Technical Stack
- **AI Model**: Gemini 2.0 Flash
- **Vision Processing**: High-detail image analysis
- **API Integration**: Windmill workflow
- **Output Format**: Excel (.xlsx)

## Data Structure
```
Columns:
- list_id: Reference ID
- Component: Work type
- Description: Details
- W/L/H: Dimensions (meters)
- Quantity: Amount
- Unit: Unit of measurement
- Price per unit: Unit price
- Total cost: Total amount
- Remark: Notes
```

## Security Features
- Company data is protected
- No exposure of detailed pricing information
- Authentication system
- Data encryption in transit

## Usage
1. Upload booth layout and component list images
2. System analyzes and categorizes objects
3. Calculates prices from database
4. Generates Excel file with download link

## Development Notes
- System developed on Dify platform
- Connects to Windmill for Excel generation
- Uses Knowledge Retrieval for price database
- Supports multiple image processing

## Project Structure
```
Ec-excel/
├── README.md                    # System documentation
├── excel.py                     # Excel generation module
├── config.py                    # System configuration
├── utils.py                     # Helper functions
├── demo.py                      # Usage examples
├── requirements.txt              # Dependencies
├── LICENSE                       # Internal use license
├── .gitignore                   # Git ignore file
└── docs/                        # Detailed documentation
    ├── README.md                # Comprehensive system overview
    └── WORKFLOW_EXAMPLES.md     # Workflow examples and screenshots
```

## Installation & Setup

### Prerequisites
- Python 3.11+
- Dify platform access
- Windmill API access

### Installation
```bash
# Clone repository
git clone <repository-url>
cd Ec-excel

# Install dependencies
pip install -r requirements.txt

# Run demo
python demo.py
```

### Configuration
1. Set environment variables for API keys
2. Configure endpoints in `config.py`
3. Set up price database in Knowledge Retrieval

## Security & Privacy
- Company data is protected
- No exposure of detailed pricing information
- Authentication system
- Data encryption in transit
- System access limited to authorized employees only

## Documentation

For detailed information about the system, please refer to:
- **[Comprehensive System Overview](docs/README.md)** - Detailed technical documentation
- **[Workflow Examples](docs/WORKFLOW_EXAMPLES.md)** - Visual examples and screenshots

## Support
For technical support or feature requests, please contact the development team.

---
*This system is developed for internal company use only* 