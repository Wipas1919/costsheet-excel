# EC - AI Cost Estimation System

## Overview
ระบบวิเคราะห์และประมาณต้นทุนงานแสดงสินค้า (Exhibition Booth) โดยใช้ AI ในการประมวลผลภาพและสร้างไฟล์ Excel

## Features
- **Image Analysis**: วิเคราะห์ภาพ Layout ของ Booth และ Component Lists
- **Object Classification**: จัดประเภทวัตถุเป็น 4 หมวดหลัก
- **Dimension Extraction**: ดึงข้อมูลขนาดจากภาพ
- **Excel Generation**: สร้างไฟล์ Cost Sheet อัตโนมัติ
- **Price Calculation**: คำนวณราคาจากฐานข้อมูล

## System Architecture

### 1. Image Processing & Analysis
- รับภาพ Layout และ Component Lists
- ใช้ AI Vision Model ในการวิเคราะห์
- จัดประเภทวัตถุ:
  - Structure (โครงสร้าง)
  - Furniture & Plant (เฟอร์นิเจอร์และต้นไม้)
  - Graphic (กราฟิก)
  - Electrical (ไฟฟ้า)

### 2. Data Processing
- แยกกราฟิกออกจากโครงสร้าง
- ตรวจสอบความถูกต้องของขนาด
- สร้าง list_id สำหรับแต่ละรายการ
- คำนวณปริมาณ (Quantity) ตามประเภท

### 3. Price Integration
- เปรียบเทียบกับฐานข้อมูลราคา
- คำนวณราคาต่อหน่วย
- คำนวณราคารวม
- เพิ่มค่ากระแสไฟฟ้า (Electrical)

### 4. Excel Generation
- ส่งข้อมูลไปยัง Windmill API
- สร้างไฟล์ Cost Sheet
- ส่งกลับลิงก์ดาวน์โหลด

## Technical Stack
- **AI Model**: Gemini 2.0 Flash
- **Vision Processing**: High-detail image analysis
- **API Integration**: Windmill workflow
- **Output Format**: Excel (.xlsx)

## Data Structure
```
Columns:
- list_id: รหัสอ้างอิง
- Component: ประเภทงาน
- Description: รายละเอียด
- W/L/H: ขนาด (เมตร)
- Quantity: ปริมาณ
- Unit: หน่วย
- Price per unit: ราคาต่อหน่วย
- Total cost: ราคารวม
- Remark: หมายเหตุ
```

## Security Features
- ข้อมูลบริษัทได้รับการปกป้อง
- ไม่เปิดเผยข้อมูลราคาที่ละเอียด
- ใช้ระบบ Authentication
- ข้อมูลถูกเข้ารหัสในการส่ง

## Usage
1. อัพโหลดภาพ Layout และ Component Lists
2. ระบบจะวิเคราะห์และจัดประเภทวัตถุ
3. คำนวณราคาจากฐานข้อมูล
4. สร้างไฟล์ Excel พร้อมลิงก์ดาวน์โหลด

## Development Notes
- ระบบพัฒนาด้วย Dify platform
- เชื่อมต่อกับ Windmill สำหรับ Excel generation
- ใช้ Knowledge Retrieval สำหรับฐานข้อมูลราคา
- รองรับการประมวลผลหลายภาพพร้อมกัน

---
*ระบบนี้พัฒนาขึ้นเพื่อใช้ภายในองค์กรเท่านั้น* 